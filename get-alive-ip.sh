#!/bin/sh
set -eu

usage() {
  echo "Usage: ${0##*/} <ip-range>"
}

if [ $# -eq 0 ]; then
  echo "Error: Target hosts must be specified"
  usage
  exit 1
fi

if [[ "$1" == "-h" ]]; then
  usage
  exit 0
fi

today=`date +%Y%m%d`
if [ ! -d ./results/${today} ]; then
  mkdir -p ./results/${today}
fi

now=`date +%Y%m%d_%H%M%S`
host_name=`echo $1 | tr "/" "_"`
nmap -v -sn $1 -oX "results/${today}/${host_name}_alive_ip_${now}.xml"